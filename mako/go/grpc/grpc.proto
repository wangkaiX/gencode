syntax = "proto3";

package ${proto_package_name};

service ${grpc_service_name} {
% for api in apis:
    rpc ${gen_upper_camel(api.name)}(${api.req.type.name}) returns (${api.resp.type.name}){}
% endfor
}

% for node in nodes:
message ${node.type.name} {
    <% i = 1 %>
    % for field in node.fields:
        <%
            if field.dimension > 0:
                repeated = 'repeated '
            else:
                repeated = ''
        %>
    ${repeated}${field.type.name} ${field.name}  = ${field.index};
        <% i = i + 1 %>
    % endfor

    % for n in node.nodes:
        <%
            if n.dimension > 0:
                repeated = 'repeated '
            else:
                repeated = ''
        %>
    ${repeated}${n.type.name} ${n.name}  = ${n.index};
        <% i = i + 1 %>
    % endfor
}

% endfor

% for enum in enums:
enum ${enum.name} {
    <% i = 0 %>
    % for value in enum.values:
    ${value} = ${i};
        <% i = i + 1 %>
    % endfor
}

% endfor
